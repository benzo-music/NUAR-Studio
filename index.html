<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NUAR Studio | Конструктор для стримеров</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-pink: #ff00ff;
            --neon-green: #00ff9d;
            --dark-bg: #0a0a14;
            --panel-bg: rgba(20, 25, 40, 0.97);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: var(--dark-bg);
            color: white;
            font-family: 'JetBrains Mono', monospace;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* ФОНЫ */
        .cyber-bg {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: 
                linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
            background-size: 60px 60px;
            opacity: 0.4;
            z-index: -1;
            animation: gridMove 40s linear infinite;
        }
        
        @keyframes gridMove {
            0% { background-position: 0 0; }
            100% { background-position: 120px 120px; }
        }
        
        /* НАВИГАЦИЯ */
        .navbar {
            background: rgba(10, 15, 30, 0.98);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 243, 255, 0.3);
            backdrop-filter: blur(20px);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            background: linear-gradient(135deg, #00f3ff, #ff00ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800;
        }
        
        /* ОСНОВНОЙ КОНТЕЙНЕР */
        .main-container {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 2rem;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* ЛЕВАЯ ПАНЕЛЬ */
        .settings-panel {
            background: var(--panel-bg);
            border-radius: 20px;
            padding: 1.5rem;
            border: 1px solid rgba(0, 243, 255, 0.2);
            backdrop-filter: blur(10px);
            height: fit-content;
            position: sticky;
            top: 100px;
        }
        
        .panel-title {
            color: #00f3ff;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .category {
            margin-bottom: 2rem;
        }
        
        .category-title {
            color: #ff00ff;
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-item {
            margin-bottom: 1.2rem;
        }
        
        label {
            display: block;
            color: #a0b8d0;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        input[type="text"], input[type="range"], select {
            width: 100%;
            padding: 12px;
            background: rgba(0, 10, 20, 0.8);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 10px;
            color: white;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
        }
        
        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #00f3ff;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }
        
        .color-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-top: 0.5rem;
        }
        
        .color-option {
            width: 35px;
            height: 35px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .color-option:hover {
            transform: scale(1.15);
        }
        
        .color-option.active {
            border-color: white;
            box-shadow: 0 0 15px currentColor;
        }
        
        /* ПРЕДПРОСМОТР */
        .preview-container {
            background: var(--panel-bg);
            border-radius: 20px;
            padding: 2.5rem;
            border: 1px solid rgba(255, 0, 255, 0.2);
            backdrop-filter: blur(10px);
            min-height: 600px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        #renderCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        
        .live-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 3.5rem;
            text-align: center;
            margin: 2rem 0;
            padding: 2rem;
            border-radius: 15px;
            background: rgba(0, 0, 0, 0.2);
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 2;
            width: 100%;
        }
        
        .main-preview {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #00f3ff;
            text-shadow: 0 0 25px #00f3ff;
        }
        
        .sub-preview {
            font-size: 1.8rem;
            opacity: 0.9;
            color: #00f3ff;
            text-shadow: 0 0 15px #00f3ff;
        }
        
        /* КНОПКИ */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 2rem;
            width: 100%;
            z-index: 2;
        }
        
        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            font-size: 1rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #00f3ff, #9d00ff);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #00ff9d, #00b36b);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ff5500, #ff9900);
            color: white;
        }
        
        .btn-secondary {
            background: rgba(0, 243, 255, 0.1);
            color: #00f3ff;
            border: 2px solid #00f3ff;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 243, 255, 0.4);
        }
        
        /* ПОДПИСКА */
        .subscription-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .subscription-box {
            background: var(--panel-bg);
            border-radius: 20px;
            padding: 2.5rem;
            border: 1px solid rgba(0, 243, 255, 0.3);
            max-width: 500px;
            width: 90%;
            text-align: center;
        }
        
        .subscription-title {
            color: #00f3ff;
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            margin-bottom: 1.5rem;
        }
        
        .subscription-features {
            text-align: left;
            margin: 2rem 0;
            color: #a0b8d0;
        }
        
        .subscription-features li {
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .price {
            font-size: 2.5rem;
            color: #00ff9d;
            font-family: 'Orbitron', sans-serif;
            margin: 1.5rem 0;
        }
        
        .subscription-btn {
            background: linear-gradient(135deg, #00f3ff, #ff00ff);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
        }
        
        .subscription-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 243, 255, 0.4);
        }
        
        .close-subscription {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* УВЕДОМЛЕНИЯ */
        .notification {
            position: fixed;
            top: 100px;
            right: 20px;
            background: linear-gradient(135deg, #00f3ff, #0099cc);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 600;
            z-index: 10000;
            animation: slideInRight 0.3s ease-out;
            max-width: 400px;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        /* СТАТУС БАР */
        .status-bar {
            background: rgba(0, 10, 20, 0.8);
            padding: 1rem;
            border-radius: 10px;
            margin-top: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #a0b8d0;
            width: 100%;
            z-index: 2;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #00ff9d;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* АДАПТИВНОСТЬ */
        @media (max-width: 992px) {
            .main-container { grid-template-columns: 1fr; padding: 1rem; }
            .settings-panel { position: static; }
            .live-text { font-size: 2.5rem; }
            .main-preview { font-size: 2.5rem; }
            .action-buttons { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="cyber-bg"></div>
    
    <!-- ПОДПИСКА -->
    <div class="subscription-overlay" id="subscriptionOverlay">
        <div class="subscription-box">
            <button class="close-subscription" id="closeSubscription">✕</button>
            <div class="subscription-title">NUAR PRO</div>
            <p style="color: #a0b8d0; margin-bottom: 1.5rem;">Премиум доступ для профессионалов</p>
            
            <div class="subscription-features">
                <li><i class="fas fa-check" style="color:#00ff9d;"></i> Без водяных знаков</li>
                <li><i class="fas fa-check" style="color:#00ff9d;"></i> Экспорт в 4K качестве</li>
                <li><i class="fas fa-check" style="color:#00ff9d;"></i> Все премиум-шаблоны</li>
                <li><i class="fas fa-check" style="color:#00ff9d;"></i> Приоритетная поддержка</li>
                <li><i class="fas fa-check" style="color:#00ff9d;"></i> Анимированные GIF без ограничений</li>
            </div>
            
            <div class="price">299₽ / месяц</div>
            
            <button class="subscription-btn" id="buySubscriptionBtn">
                <i class="fas fa-crown"></i> КУПИТЬ ПОДПИСКУ
            </button>
            
            <p style="color: #a0b8d0; font-size: 0.9rem; margin-top: 1.5rem;">
                После оплаты отправьте скриншот чека на nuar.support@gmail.com
            </p>
        </div>
    </div>
    
    <!-- НАВИГАЦИЯ -->
    <nav class="navbar">
        <div class="logo">NUAR STUDIO</div>
        <button class="btn-secondary" id="subscriptionBtn" style="padding: 10px 20px;">
            <i class="fas fa-crown"></i> PRO ВЕРСИЯ
        </button>
    </nav>
    
    <!-- ОСНОВНОЙ КОНТЕЙНЕР -->
    <div class="main-container">
        <!-- ЛЕВАЯ ПАНЕЛЬ -->
        <div class="settings-panel">
            <div class="panel-title">
                <i class="fas fa-sliders-h"></i> НАСТРОЙКИ
            </div>
            
            <!-- ТЕКСТ -->
            <div class="category">
                <div class="category-title">
                    <i class="fas fa-font"></i> ТЕКСТ
                </div>
                <div class="control-item">
                    <label>Основной текст:</label>
                    <input type="text" id="mainText" value="CYBERSTREAMER LIVE" maxlength="30">
                </div>
                <div class="control-item">
                    <label>Второстепенный текст:</label>
                    <input type="text" id="subText" value="Играет в Cyberpunk 2077" maxlength="40">
                </div>
            </div>
            
            <!-- ЦВЕТА -->
            <div class="category">
                <div class="category-title">
                    <i class="fas fa-palette"></i> ЦВЕТА
                </div>
                <div class="control-item">
                    <label>Цвет текста:</label>
                    <div class="color-grid">
                        <div class="color-option active" style="background:#00f3ff;" data-color="#00f3ff"></div>
                        <div class="color-option" style="background:#ff00ff;" data-color="#ff00ff"></div>
                        <div class="color-option" style="background:#00ff9d;" data-color="#00ff9d"></div>
                        <div class="color-option" style="background:#ff5500;" data-color="#ff5500"></div>
                        <div class="color-option" style="background:#9d00ff;" data-color="#9d00ff"></div>
                        <div class="color-option" style="background:#ff009d;" data-color="#ff009d"></div>
                    </div>
                </div>
            </div>
            
            <!-- ЭФФЕКТЫ -->
            <div class="category">
                <div class="category-title">
                    <i class="fas fa-magic"></i> ЭФФЕКТЫ
                </div>
                <div class="control-item">
                    <label>Сила свечения: <span id="glowValue">25</span>px</label>
                    <input type="range" id="glowStrength" min="5" max="60" value="25">
                </div>
                <div class="control-item">
                    <label>Анимированный фон:</label>
                    <select id="bgAnimation">
                        <option value="none">Нет</option>
                        <option value="grid" selected>Движущаяся сетка</option>
                        <option value="particles">Летающие частицы</option>
                        <option value="waves">Неоновые волны</option>
                        <option value="circuits">Электронные схемы</option>
                        <option value="scan">Сканирующий луч</option>
                    </select>
                </div>
            </div>
            
            <!-- БЫСТРЫЕ ДЕЙСТВИЯ -->
            <div class="category">
                <div class="category-title">
                    <i class="fas fa-bolt"></i> БЫСТРЫЕ ДЕЙСТВИЯ
                </div>
                <button class="action-btn btn-secondary" id="randomBtn" style="width:100%; margin-bottom:0.5rem;">
                    <i class="fas fa-random"></i> СЛУЧАЙНЫЙ ДИЗАЙН
                </button>
                <button class="action-btn btn-secondary" id="resetBtn" style="width:100%;">
                    <i class="fas fa-redo"></i> СБРОСИТЬ
                </button>
            </div>
        </div>
        
        <!-- ПРЕДПРОСМОТР -->
        <div class="preview-section">
            <div class="preview-container">
                <!-- КАНВАС ДЛЯ ФОНОВ -->
                <canvas id="renderCanvas"></canvas>
                
                <!-- ЖИВОЙ ПРЕДПРОСМОТР -->
                <div class="live-text">
                    <div>
                        <div class="main-preview" id="mainPreview">CYBERSTREAMER LIVE</div>
                        <div class="sub-preview" id="subPreview">Играет в Cyberpunk 2077</div>
                    </div>
                </div>
                
                <!-- КНОПКИ ДЕЙСТВИЙ -->
                <div class="action-buttons">
                    <button class="action-btn btn-primary" id="downloadSimpleBtn">
                        <i class="fas fa-download"></i> СКАЧАТЬ PNG
                    </button>
                    <button class="action-btn btn-success" id="downloadFullBtn">
                        <i class="fas fa-image"></i> С ЭФФЕКТАМИ
                    </button>
                    <button class="action-btn btn-warning" id="downloadGifBtn">
                        <i class="fas fa-film"></i> СКАЧАТЬ GIF
                    </button>
                    <button class="action-btn btn-secondary" id="copyCssBtn">
                        <i class="fas fa-code"></i> КОПИРОВАТЬ CSS
                    </button>
                </div>
                
                <!-- СТАТУС БАР -->
                <div class="status-bar">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div class="status-dot"></div>
                        <span>Готов к экспорту</span>
                    </div>
                    <div>
                        <span id="fileSize">~450 KB</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== СОСТОЯНИЕ ==========
        const state = {
            mainText: 'CYBERSTREAMER LIVE',
            subText: 'Играет в Cyberpunk 2077',
            color: '#00f3ff',
            glowStrength: 25,
            bgAnimation: 'grid',
            isSubscribed: false,
            particles: []
        };
        
        // ========== DOM ЭЛЕМЕНТЫ ==========
        const elements = {
            canvas: document.getElementById('renderCanvas'),
            mainPreview: document.getElementById('mainPreview'),
            subPreview: document.getElementById('subPreview'),
            mainText: document.getElementById('mainText'),
            subText: document.getElementById('subText'),
            glowStrength: document.getElementById('glowStrength'),
            glowValue: document.getElementById('glowValue'),
            bgAnimation: document.getElementById('bgAnimation'),
            colorOptions: document.querySelectorAll('.color-option'),
            downloadSimpleBtn: document.getElementById('downloadSimpleBtn'),
            downloadFullBtn: document.getElementById('downloadFullBtn'),
            downloadGifBtn: document.getElementById('downloadGifBtn'),
            copyCssBtn: document.getElementById('copyCssBtn'),
            randomBtn: document.getElementById('randomBtn'),
            resetBtn: document.getElementById('resetBtn'),
            subscriptionBtn: document.getElementById('subscriptionBtn'),
            subscriptionOverlay: document.getElementById('subscriptionOverlay'),
            closeSubscription: document.getElementById('closeSubscription'),
            buySubscriptionBtn: document.getElementById('buySubscriptionBtn'),
            fileSize: document.getElementById('fileSize')
        };
        
        // ========== ИНИЦИАЛИЗАЦИЯ ==========
        function init() {
            setupCanvas();
            setupEventListeners();
            updatePreview();
            drawBackground();
            showNotification('NUAR Studio загружен!');
            
            // Проверяем подписку в localStorage
            if (localStorage.getItem('nuar_pro') === 'true') {
                state.isSubscribed = true;
                showNotification('PRO версия активирована!');
                elements.subscriptionBtn.innerHTML = '<i class="fas fa-crown"></i> PRO АКТИВНА';
                elements.subscriptionBtn.style.background = 'linear-gradient(135deg, #00ff9d, #00b36b)';
            }
        }
        
        function setupCanvas() {
            const container = document.querySelector('.preview-container');
            if (container && elements.canvas) {
                elements.canvas.width = container.clientWidth;
                elements.canvas.height = container.clientHeight;
            }
        }
        
        function setupEventListeners() {
            // Текст
            elements.mainText.addEventListener('input', (e) => {
                state.mainText = e.target.value || 'Ваш текст';
                updatePreview();
            });
            
            elements.subText.addEventListener('input', (e) => {
                state.subText = e.target.value;
                updatePreview();
            });
            
            // Цвета
            elements.colorOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    elements.colorOptions.forEach(o => o.classList.remove('active'));
                    e.target.classList.add('active');
                    state.color = e.target.dataset.color;
                    updatePreview();
                    drawBackground();
                });
            });
            
            // Эффекты
            elements.glowStrength.addEventListener('input', (e) => {
                state.glowStrength = parseInt(e.target.value);
                elements.glowValue.textContent = state.glowStrength;
                updatePreview();
            });
            
            elements.bgAnimation.addEventListener('change', (e) => {
                state.bgAnimation = e.target.value;
                drawBackground();
            });
            
            // Кнопки
            elements.downloadSimpleBtn.addEventListener('click', () => downloadImage(false));
            elements.downloadFullBtn.addEventListener('click', () => downloadImage(true));
            elements.downloadGifBtn.addEventListener('click', createGif);
            elements.copyCssBtn.addEventListener('click', copyCss);
            elements.randomBtn.addEventListener('click', randomDesign);
            elements.resetBtn.addEventListener('click', resetDesign);
            
            // Подписка
            elements.subscriptionBtn.addEventListener('click', () => {
                elements.subscriptionOverlay.style.display = 'flex';
            });
            
            elements.closeSubscription.addEventListener('click', () => {
                elements.subscriptionOverlay.style.display = 'none';
            });
            
            elements.buySubscriptionBtn.addEventListener('click', () => {
                window.open('https://yoomoney.ru/to/4100118454141760', '_blank');
                showNotification('После оплаты отправьте скриншот на nuar.support@gmail.com');
            });
            
            // Адаптивность
            window.addEventListener('resize', () => {
                setupCanvas();
                drawBackground();
            });
        }
        
        // ========== ОБНОВЛЕНИЕ ПРЕДПРОСМОТРА ==========
        function updatePreview() {
            elements.mainPreview.textContent = state.mainText;
            elements.subPreview.textContent = state.subText;
            
            // Обновляем цвет и свечение
            elements.mainPreview.style.color = state.color;
            elements.subPreview.style.color = state.color;
            elements.mainPreview.style.textShadow = `0 0 ${state.glowStrength}px ${state.color}`;
            elements.subPreview.style.textShadow = `0 0 ${state.glowStrength * 0.7}px ${state.color}`;
        }
        
        // ========== РИСОВАНИЕ ФОНОВ ==========
        function drawBackground() {
            if (!elements.canvas || !elements.canvas.getContext) return;
            
            const ctx = elements.canvas.getContext('2d');
            if (!ctx) return;
            
            const width = elements.canvas.width;
            const height = elements.canvas.height;
            const time = Date.now() * 0.001;
            
            // Очищаем канвас
            ctx.fillStyle = '#0a0a14';
            ctx.fillRect(0, 0, width, height);
            
            // Рисуем выбранный фон
            switch(state.bgAnimation) {
                case 'grid':
                    drawGrid(ctx, width, height, time);
                    break;
                case 'particles':
                    drawParticles(ctx, width, height, time);
                    break;
                case 'waves':
                    drawWaves(ctx, width, height, time);
                    break;
                case 'circuits':
                    drawCircuits(ctx, width, height, time);
                    break;
                case 'scan':
                    drawScan(ctx, width, height, time);
                    break;
                default:
                    // Нет фона
                    break;
            }
        }
        
        function drawGrid(ctx, width, height, time) {
            ctx.strokeStyle = 'rgba(0, 243, 255, 0.15)';
            ctx.lineWidth = 1;
            
            const offsetX = (time * 20) % 60;
            const offsetY = (time * 20) % 60;
            
            for (let x = -offsetX; x < width; x += 60) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
            
            for (let y = -offsetY; y < height; y += 60) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
        }
        
        function drawParticles(ctx, width, height, time) {
            // Создаем частицы если их нет
            if (state.particles.length === 0) {
                for (let i = 0; i < 50; i++) {
                    state.particles.push({
                        x: Math.random() * width,
                        y: Math.random() * height,
                        size: Math.random() * 3 + 1,
                        speedX: (Math.random() - 0.5) * 2,
                        speedY: (Math.random() - 0.5) * 2,
                        color: Math.random() > 0.5 ? state.color : '#ff00ff'
                    });
                }
            }
            
            // Обновляем и рисуем частицы
            for (const p of state.particles) {
                p.x += p.speedX;
                p.y += p.speedY;
                
                // Отскок от границ
                if (p.x < 0 || p.x > width) p.speedX *= -1;
                if (p.y < 0 || p.y > height) p.speedY *= -1;
                
                ctx.fillStyle = p.color;
                ctx.globalAlpha = 0.3;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.globalAlpha = 1;
        }
        
        function drawWaves(ctx, width, height, time) {
            ctx.strokeStyle = state.color;
            ctx.lineWidth = 2;
            ctx.globalAlpha = 0.3;
            
            for (let i = 0; i < 5; i++) {
                const amplitude = 20 + i * 10;
                const frequency = 0.02 + i * 0.008;
                const offset = i * 50;
                
                ctx.beginPath();
                for (let x = 0; x < width; x++) {
                    const y = height / 2 + amplitude * Math.sin(x * frequency + time * 2 + i) + offset;
                    if (x === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            }
            ctx.globalAlpha = 1;
        }
        
        function drawCircuits(ctx, width, height, time) {
            ctx.strokeStyle = 'rgba(0, 255, 157, 0.2)';
            ctx.lineWidth = 2;
            
            for (let i = 0; i < 8; i++) {
                const x = width * (0.2 + Math.sin(time + i) * 0.1 + 0.3);
                const y = height * (0.2 + Math.cos(time + i) * 0.1 + 0.3);
                const radius = 40 + Math.sin(time * 2 + i) * 20;
                
                ctx.beginPath();
                ctx.arc(x, y, radius, 0, Math.PI * 2);
                ctx.stroke();
            }
        }
        
        function drawScan(ctx, width, height, time) {
            ctx.fillStyle = 'rgba(0, 243, 255, 0.05)';
            for (let y = 0; y < height; y += 4) {
                ctx.fillRect(0, y, width, 2);
            }
            
            const scanY = (time * 100) % height;
            ctx.fillStyle = 'rgba(0, 243, 255, 0.3)';
            ctx.fillRect(0, scanY, width, 3);
        }
        
        // ========== СКАЧИВАНИЕ ИЗОБРАЖЕНИЙ ==========
        function downloadImage(withEffects) {
            showNotification('Создаем изображение...');
            
            try {
                const tempCanvas = document.createElement('canvas');
                tempCanvas.width = 1920;
                tempCanvas.height = 500;
                const ctx = tempCanvas.getContext('2d');
                
                if (!ctx) throw new Error('Не удалось создать canvas');
                
                // Фон
                ctx.fillStyle = '#0a0a14';
                ctx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                
                // Фоновые эффекты
                if (withEffects) {
                    const time = Date.now() * 0.001;
                    switch(state.bgAnimation) {
                        case 'grid':
                            drawGrid(ctx, tempCanvas.width, tempCanvas.height, time);
                            break;
                        case 'particles':
                            drawParticles(ctx, tempCanvas.width, tempCanvas.height, time);
                            break;
                        case 'waves':
                            drawWaves(ctx, tempCanvas.width, tempCanvas.height, time);
                            break;
                        case 'circuits':
                            drawCircuits(ctx, tempCanvas.width, tempCanvas.height, time);
                            break;
                    }
                }
                
                // Текст
                ctx.font = 'bold 100px Orbitron';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillStyle = state.color;
                ctx.shadowColor = state.color;
                ctx.shadowBlur = state.glowStrength;
                
                ctx.fillText(state.mainText, tempCanvas.width / 2, tempCanvas.height / 2 - 40);
                ctx.shadowBlur = 0;
                
                if (state.subText) {
                    ctx.font = 'bold 40px Orbitron';
                    ctx.fillStyle = state.color;
                    ctx.fillText(state.subText, tempCanvas.width / 2, tempCanvas.height / 2 + 60);
                }
                
                // Водяной знак (если нет подписки)
                if (!state.isSubscribed) {
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
                    ctx.font = 'bold 24px Orbitron';
                    ctx.textAlign = 'left';
                    ctx.fillText('Создано в NUAR Studio', 50, tempCanvas.height - 30);
                }
                
                // Скачивание
                const timestamp = new Date().toISOString().slice(0,19).replace(/:/g,'-');
                const filename = `nuar-${withEffects ? 'full' : 'simple'}-${timestamp}.png`;
                
                const link = document.createElement('a');
                link.download = filename;
                link.href = tempCanvas.toDataURL('image/png');
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showNotification('Изображение скачано!');
                
            } catch (error) {
                console.error('Ошибка:', error);
                showNotification('Ошибка при создании изображения');
            }
        }
        
        // ========== GIF ==========
        function createGif() {
            showNotification('GIF создается... Используйте PNG для лучшего качества');
            
            // Альтернатива: открываем страницу с инструкциями
            const win = window.open('', '_blank');
            win.document.write(`
                <html>
                <head><title>Создание GIF</title></head>
                <body>
                    <h1>Как создать GIF из вашего дизайна:</h1>
                    <p>1. Скачайте PNG с эффектами (кнопка "С ЭФФЕКТАМИ")</p>
                    <p>2. Перейдите на <a href="https://ezgif.com/maker" target="_blank">EZGIF.com</a></p>
                    <p>3. Загрузите изображение и создайте GIF</p>
                    <p>4. Для анимированных GIF с пульсацией создайте несколько PNG с разной силой свечения</p>
                </body>
                </html>
            `);
        }
        
        // ========== ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ ==========
        function copyCss() {
            const css = `.header-text {
    font-family: 'Orbitron', sans-serif;
    font-size: 5rem;
    color: ${state.color};
    text-shadow: 0 0 ${state.glowStrength}px ${state.color};
}`;
            
            navigator.clipboard.writeText(css).then(() => {
                showNotification('CSS скопирован!');
            });
        }
        
        function randomDesign() {
            const colors = ['#00f3ff', '#ff00ff', '#00ff9d', '#ff5500', '#9d00ff', '#ff009d'];
            const bgAnimations = ['none', 'grid', 'particles', 'waves', 'circuits', 'scan'];
            const mainTexts = ['CYBERSTREAMER LIVE', 'NEON NIGHTS', 'SYNTHWAVE RADIO', 'GAME ZONE', 'TECH TALK'];
            const subTexts = ['Прямой эфир 24/7', 'Играю в лучшие игры', 'Создаю цифровое искусство', 'Обсуждаю технологии'];
            
            state.color = colors[Math.floor(Math.random() * colors.length)];
            state.glowStrength = 15 + Math.floor(Math.random() * 35);
            state.bgAnimation = bgAnimations[Math.floor(Math.random() * bgAnimations.length)];
            state.mainText = mainTexts[Math.floor(Math.random() * mainTexts.length)];
            state.subText = subTexts[Math.floor(Math.random() * subTexts.length)];
            
            // Обновляем UI
            elements.colorOptions.forEach(o => o.classList.remove('active'));
            document.querySelector(`[data-color="${state.color}"]`).classList.add('active');
            elements.glowStrength.value = state.glowStrength;
            elements.glowValue.textContent = state.glowStrength;
            elements.bgAnimation.value = state.bgAnimation;
            elements.mainText.value = state.mainText;
            elements.subText.value = state.subText;
            
            updatePreview();
            drawBackground();
            
            showNotification('Случайный дизайн создан!');
        }
        
        function resetDesign() {
            state.mainText = 'CYBERSTREAMER LIVE';
            state.subText = 'Играет в Cyberpunk 2077';
            state.color = '#00f3ff';
            state.glowStrength = 25;
            state.bgAnimation = 'grid';
            
            elements.colorOptions.forEach(o => o.classList.remove('active'));
            document.querySelector(`[data-color="#00f3ff"]`).classList.add('active');
            elements.glowStrength.value = 25;
            elements.glowValue.textContent = '25';
            elements.bgAnimation.value = 'grid';
            elements.mainText.value = 'CYBERSTREAMER LIVE';
            elements.subText.value = 'Играет в Cyberpunk 2077';
            
            updatePreview();
            drawBackground();
            
            showNotification('Дизайн сброшен');
        }
        
        function showNotification(message) {
            // Удаляем старые уведомления
            document.querySelectorAll('.notification').forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `<i class="fas fa-info-circle"></i> ${message}`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-in forwards';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // ========== ЗАПУСК ==========
        window.addEventListener('load', init);
        
        // Анимация фона
        function animate() {
            if (state.bgAnimation !== 'none') {
                drawBackground();
            }
            requestAnimationFrame(animate);
        }
        
        // Запускаем анимацию
        animate();
    </script>
</body>
</html>
